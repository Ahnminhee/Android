### Activity lifecycle

- 사용자가 앱을 탐색하고, 앱에서 나가고, 앱으로 다시 돌아가면, 앱의 Activity 인스턴스는 수명 주기 안에서 서로 다른 상태로 전환된다.

- Activity 클래스는 활동이 상태변화를 알아차릴 수 있는 여러 콜백을 제공한다.

- 사용자가 활동을 벗어났다가 다시 돌아왔을 때 활동이 작동하는 방식을 수명 주기 콜백 메서드에서 선언할 수 있다.

- 상태 변화에 알맞은 작업을 하고 적절하게 전환을 처리하면 앱이 안정적으로 기능할 수 있다.



##### onCreate()

**시스템이 먼저 활동을 생성할 때 실행되는 콜백** 으로 필수적으로 구현해야 한다.

- 액티비티가 Launch되고 나서 최초에 실행되는 부분이다.
- 데이터 목록을 바인딩하고 ViewModel 연결, 일부 클래스 범위 변수를 인스턴스화 할 수 있다.
- savedInstanceState 매게 변수를 수신한다. 
  - 이전 저장 상태가 포함된 Bundle 객체이다. 처음 생성된 경우 Bundle 객체의 값은 null이다.
- xml 파일을 정의하고 새로운 View를 ViewGroup에 넣어서 뷰 계층 구조를 빌드할 수 있다.

onCreate() 메서드가 실행을 완료하면 시작됨 상태가 되고 시스템이 연달아 onStart(), onResume() 메서드를 호출한다.



##### onStart()

**활동이 시작됨 상태에 들어갈 때 호출되는 콜백** 으로 활동이 사용자에게 표시된다.

- 액티비티를 사용자에게 보이도록 해주는 부분
- UI를 관리하는 코드 초기화한다.
- BroadcastReceiver는 이 단계에서 등록한다.

생성됨 상태와 마찬가지로 활동은 시작됨 상태에 머무르지 않는다. 이 콜백이 완료되면 활동이 재개됨 상태로 들어간다.



##### onResume()

**앱이 사용자와 상호작용** 한다.

- 사용자가 다른 활동으로 이동하거나 기기 화면이 꺼질 때와 같은 상황에 이곳에 머문다.
- 사용자에게 보이는 동안 실행해야 하는 모든 기능을 활성화 활 수 있다. ex) 카메라 미리보기
- 방해되는 이벤트 발생시 onPause() 콜백 호출

활동이 일시중지됨 상태에서 재개됨 상태로 돌아오면 시스템이 onResume() 메서드를 다시 한번 호출한다. 

​	-> onResume()을 구현하여 onPause() 중에 해제하는 구성요소를 초기화하고, 활동이 재개됨 상태로 전환될 때마다 필요한 다른 초기화 작업도 수행



##### onPause()

시스템은 **사용자가 활동을 떠나는 것** 을 나타내는 메소드로 활동이 포그라운드에 있지 않게 되었다는 것을 나타낸다.

​	-> 사용자가 멀티 윈도우 모드에 있을 경우에는 표시 될 수도 있다.

- 사용자가 필요로 하지 않을 때 배터리 수명에 영향을 미칠 수 있는 모든 리소스 해제 가능하다. 
  -  멀티 윈도우 모드를 더욱 잘 지원하기 위해 UI 관련 리소스와 작업은 onStop()을 권장한다.
- 앱 또는 사용자의 데이터를 저장, 네트워크 호출, 디비 트랜잭션을 실행하면 안된다. 아주 잠깐 실행되서 저장 작업을 실행하기에는 시간이 부족하다.



##### onStop()

**활동이 사용자에게 더 이상 표시되지 않으면** 중단됨 상태에 들어간 뒤 호출한다. 새로 시작된 활동이 화면 전체를 차지할 경우에 적용된다.

- 사용자에게 앱이 보이지 않을 때 중요하지 않은 리소스 해제하거나 조정해야 한다. 

  ex) 애니메이션, 위치 업데이트

- onPause()와 다르게 멀티 윈도우 모드에서 활동을 보고 있더라도 UI 관련 작업이 계속 진행된다.

- 데이터베이스에 저장할 적절한 시기를 찾지 못하면 onStop() 상태일 때 저장 

onStop()에 들어오면 Activity 객체는 메모리 안에 머무르게 된다. 활동이 다시 시작되면 이 정보를 다시 호출한다.



##### onDestroy()

**활동이 소멸되기 전** 에 호출된다. 시스템은 둘 중 하나일 때 이 콜백은 호출한다.

1. 사용자가 활동을 완전히 닫거나 활동에서 finish()를 호출하여 활동이 종료되는 경우
2. 기기 회전 또는 멀티 윈도우와 같은 구성 변경으로 인해 시스템이 일시적으로 활동을 소멸시키는 경우

- 소멸되는 이유를 결정하는 로직을 입력하는 대신 ViewModel 객체를 사용하여 관련 뷰 데이터를 포함해야 한다.
  - 구성 변경으로 인해 다시 생성될 경우 ViewModel은 그대로 보존되어 다음 활동 인스턴스에 전달되므로 추가 작업이 필요 없다.
  - 다시 생성되지 않을 경우 ViewModel은 onCleared() 메서드를 호출하여 모든 데이터를 정리해야한다.

- 마지막 콜백이며 구성변경으로 인해 호출되는 경우 시스템이 즉시 새 활동 인스턴스를 생성한 다음 onCreate() 호출한다.
- 이전의 콜백에서 아직 해제되지 않은 모든 리소스를 해제해야 한다 -> onStop()

